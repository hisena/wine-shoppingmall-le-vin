<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
                       
<!-- Product, Price table에 접근하는 sql -->  
                      
<!-- 네임스페이스(사용영역) 설정 -->
<mapper namespace="kr.or.kosta.levin.product">
	
	<!-- 전체상품 조회 -->
	<select id="listByPage" parameterType="searchPagination" resultType="Product" >
		SELECT productId, 
			   productNameKor, 
			   price, 
			   kind 
		FROM   (SELECT Ceil(ROWNUM / #{perPageNum}) request_page, 
               		   productId, 
               		   productNameKor, 
               		   price, 
               		   kind 
        		FROM   (SELECT pro.product_id       productId, 
                       		   pro.product_name_kor productNameKor, 
                       		   pri.price            price, 
                       		   pro.kind             kind 
                		FROM   levin_products pro 
                       	INNER JOIN levin_prices pri 
                        ON pro.product_id = pri.product_id
                        <if test="searchKeword != null">
							WHERE pro.kind = #{searchKeword}
						</if>
                		ORDER  BY pro.product_id)) 
		WHERE  request_page = #{currentPage}
	</select>
	 
</mapper>