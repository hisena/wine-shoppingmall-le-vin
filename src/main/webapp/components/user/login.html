<meta charset="utf-8">
<input type="email" name="email" placeholder="이메일">
<input type="password" name="password" placeholder="비밀번호">
<div class="tabs__checkbox">
  <input type="checkbox" id="checkbox"><span>아이디 저장하기 </span> <span
    class="forget"><a href="components/user/find_password.html" role="tab">비밀번호 찾기</a></span>
</div>
<input type="submit" value="로그인" id="loginButton">

<!-- 로그인 Ajax -->
<script type="text/javascript">
var baseUrl = 'http://localhost:80/le-vin/';
/**
 * 로그인 양식의 유효성 검사를 하는 자바 스크립트 파일
 */
var loginFormRequiredValidations = [
	Validation.isValidEmail,
	Validation.isValidPassword,
];

$("form.login").submit(function(event) {
	event.preventDefault();
	
	var validationResult = Validation.validAllInputs(loginFormRequiredValidations);
	
	if(!validationResult) {
		return false;
	}
	
	var data = $(this).serialize();
	
	$.ajax(baseUrl + "user/login.mall", {
		method: "post",
		data: data,
		dataType: "json",
		success: function(data) {
			console.log(data.EMAIL);
			if ($("#checkbox").is(":checked") == true) {
				setCookie('email', data.EMAIL, 30);
			} else {
				setInstanceCookie('email', data.EMAIL);
			}
			route(event, null);
		},
		error: function(data) {
			snackbar('존재하지 않는 회원입니다.');
		}
	});
	
	return false;
});

//쿠키 생성
function setCookie(cname,cvalue,exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires=" + d.toGMTString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}
// 기간 없는 쿠키 생성
function setInstanceCookie(cname,cvalue) {
    document.cookie = cname + "=" + cvalue + ";path=/";
}
</script>
<!-- 스낵바 -->
<script>
function snackbar(text) {
    var x = document.getElementById("snackbar");
    x.className = "show";
    x.innerHTML = text;
    setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
}
</script>